---
import {
  Search,
  ArrowRight,
  Shield,
  Zap,
  CheckCircle,
  Command,
  Sparkles,
  Lock,
  Cpu,
} from "lucide-react";
import { useTranslations } from "../i18n/utils";
import { languages } from "../i18n/ui";

const { lang } = Astro.params;
const t = useTranslations(lang as keyof typeof languages);

const typewriterPhrases = [
  t("hero.typewriter1"),
  t("hero.typewriter2"),
  t("hero.typewriter3"),
  t("hero.typewriter4"),
  t("hero.typewriter5"),
];
---

<section
  class="relative min-h-[90vh] flex flex-col items-center justify-center overflow-hidden pt-32 pb-20 lg:pt-48 lg:pb-32"
>
  {/* Dynamic Background */}
  <div class="absolute inset-0 -z-10 bg-[var(--color-background)]">
    {/* Animated Blobs - Amber/Orange/Yellow Website Theme */}
    <div
      class="absolute top-0 -left-4 w-96 h-96 bg-amber-400/30 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-blob"
    >
    </div>
    <div
      class="absolute top-0 -right-4 w-96 h-96 bg-orange-400/30 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-blob animation-delay-2000"
    >
    </div>
    <div
      class="absolute -bottom-8 left-20 w-96 h-96 bg-yellow-400/30 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-blob animation-delay-4000"
    >
    </div>

    {/* Grid Pattern Overlay */}
    <div
      class="absolute inset-0 bg-[linear-gradient(to_right,#8080800a_1px,transparent_1px),linear-gradient(to_bottom,#8080800a_1px,transparent_1px)] bg-[size:24px_24px] [mask-image:radial-gradient(ellipse_60%_50%_at_50%_0%,#000_70%,transparent_100%)]"
    >
    </div>

    {/* Noise Texture */}
    <div
      class="absolute inset-0 opacity-[0.03] pointer-events-none bg-[url('https://grainy-gradients.vercel.app/noise.svg')]"
    >
    </div>
  </div>

  <div
    class="container mx-auto px-4 relative z-10 flex flex-col items-center text-center"
  >
    {/* Badge */}
    <div
      class="inline-flex items-center gap-2 px-4 py-2 rounded-full bg-[var(--color-card)]/80 backdrop-blur-md border border-[var(--color-border)] shadow-sm mb-8 animate-fade-up hover:border-amber-500/50 transition-colors cursor-default"
    >
      <Shield className="w-4 h-4 text-amber-500" />
      <span class="text-sm font-medium text-[var(--color-muted-foreground)]"
        >{t("hero.badge")}</span
      >
    </div>

    {/* Main Headline */}
    <h1
      class="text-5xl md:text-7xl lg:text-8xl font-bold tracking-tighter text-[var(--color-foreground)] mb-6 animate-fade-up [animation-delay:100ms] leading-[1.1]"
    >
      {t("hero.titleMain")}<br />
      <span
        class="text-transparent bg-clip-text bg-gradient-to-r from-amber-500 via-orange-500 to-yellow-500"
      >
        {t("hero.titleHighlight")}
      </span>
    </h1>

    {/* Dynamic Typewriter Subtitle */}
    <div
      class="h-8 md:h-12 mb-8 flex items-center justify-center animate-fade-up [animation-delay:200ms]"
    >
      <div
        class="text-xl md:text-3xl font-mono text-[var(--color-muted-foreground)] opacity-90 flex items-center gap-3"
      >
        <span class="text-amber-500 font-bold">&gt;</span>
        <span
          id="typewriter-text"
          class="text-[var(--color-foreground)]"
          data-phrases={JSON.stringify(typewriterPhrases)}></span>
        <span class="animate-pulse w-3 h-8 md:h-10 bg-amber-500/50 block ml-1"
        ></span>
      </div>
    </div>

    <p
      class="text-lg md:text-xl text-[var(--color-muted-foreground)] max-w-2xl mx-auto mb-12 animate-fade-up [animation-delay:300ms] leading-relaxed"
    >
      {t("hero.subtitle")}
    </p>

    {/* Interactive Command Center (Search) */}
    <div
      class="w-full max-w-2xl relative group animate-fade-up [animation-delay:400ms] z-20"
    >
      <div
        class="absolute -inset-1 bg-gradient-to-r from-amber-500/20 via-orange-500/20 to-yellow-500/20 rounded-2xl blur opacity-25 group-hover:opacity-50 transition duration-500"
      >
      </div>
      <button
        id="hero-search-trigger"
        class="relative w-full bg-[var(--color-card)]/90 backdrop-blur-xl border border-[var(--color-border)] rounded-xl py-4 px-6 flex items-center gap-4 shadow-lg transition-all duration-300 hover:scale-[1.01] hover:border-amber-500/30 text-left"
      >
        <Search className="w-5 h-5 text-[var(--color-muted-foreground)]" />
        <span
          class="text-lg text-[var(--color-muted-foreground)] text-left flex-1 font-medium select-none truncate"
        >
          {t("hero.searchPlaceholder")}
        </span>
        <div
          class="hidden md:flex items-center gap-2 px-2 py-1 bg-[var(--color-muted)] rounded-md border border-[var(--color-border)]"
        >
          <Command className="w-3 h-3 text-[var(--color-muted-foreground)]" />
          <span
            class="text-xs font-mono font-bold text-[var(--color-muted-foreground)]"
            >K</span
          >
        </div>
      </button>

      {/* Quick Suggestions */}
      <div
        class="mt-4 flex flex-wrap justify-center gap-2 opacity-0 -translate-y-2 group-hover:opacity-100 group-hover:translate-y-0 transition-all duration-300 delay-100 pointer-events-none group-hover:pointer-events-auto"
      >
        <span
          class="text-xs text-[var(--color-muted-foreground)] py-1.5 font-medium"
          >{t("hero.try")}</span
        >
        <a
          href={`/${lang}/tools/json-formatter`}
          class="text-xs px-3 py-1.5 rounded-full bg-[var(--color-card)] border border-[var(--color-border)] hover:border-amber-500 hover:text-amber-600 dark:hover:text-amber-400 text-[var(--color-muted-foreground)] transition-colors"
          >JSON Formatter</a
        >
        <a
          href={`/${lang}/tools/compressor`}
          class="text-xs px-3 py-1.5 rounded-full bg-[var(--color-card)] border border-[var(--color-border)] hover:border-amber-500 hover:text-amber-600 dark:hover:text-amber-400 text-[var(--color-muted-foreground)] transition-colors"
          >Image Compressor</a
        >
        <a
          href={`/${lang}/tools/password-generator`}
          class="text-xs px-3 py-1.5 rounded-full bg-[var(--color-card)] border border-[var(--color-border)] hover:border-amber-500 hover:text-amber-600 dark:hover:text-amber-400 text-[var(--color-muted-foreground)] transition-colors"
          >Password Gen</a
        >
      </div>
    </div>
  </div>

  {/* Floating Elements (Decorative) */}
  <div
    class="absolute top-1/3 left-[10%] hidden xl:block animate-float opacity-50"
  >
    <div
      class="p-3 rounded-2xl bg-[var(--color-card)]/40 backdrop-blur-md border border-[var(--color-border)] shadow-sm rotate-[-6deg]"
    >
      <Lock className="w-8 h-8 text-amber-500" />
    </div>
  </div>
  <div
    class="absolute bottom-1/3 right-[10%] hidden xl:block animate-float [animation-delay:2s] opacity-50"
  >
    <div
      class="p-3 rounded-2xl bg-[var(--color-card)]/40 backdrop-blur-md border border-[var(--color-border)] shadow-sm rotate-[6deg]"
    >
      <Cpu className="w-8 h-8 text-orange-500" />
    </div>
  </div>

  <style>
    .animation-delay-2000 {
      animation-delay: 2s;
    }
    .animation-delay-4000 {
      animation-delay: 4s;
    }
    @keyframes float {
      0%,
      100% {
        transform: translateY(0);
      }
      50% {
        transform: translateY(-15px);
      }
    }
    .animate-float {
      animation: float 5s ease-in-out infinite;
    }
  </style>

  <script>
    const searchTrigger = document.getElementById("hero-search-trigger");
    if (searchTrigger) {
      searchTrigger.addEventListener("click", () => {
        document.dispatchEvent(new CustomEvent("open-search"));
      });
    }

    // Typewriter Effect
    const typeWriterElement = document.getElementById("typewriter-text");

    if (typeWriterElement) {
      // Get phrases from data attribute
      const phrases = JSON.parse(typeWriterElement.dataset.phrases || "[]");

      let phraseIndex = 0;
      let charIndex = 0;
      let isDeleting = false;
      let typeSpeed = 100;

      function type() {
        if (!typeWriterElement) return; // Safety check
        const currentPhrase = phrases[phraseIndex];

        if (isDeleting) {
          typeWriterElement.textContent = currentPhrase.substring(
            0,
            charIndex - 1,
          );
          charIndex--;
          typeSpeed = 40;
        } else {
          typeWriterElement.textContent = currentPhrase.substring(
            0,
            charIndex + 1,
          );
          charIndex++;
          typeSpeed = 80;
        }

        if (!isDeleting && charIndex === currentPhrase.length) {
          isDeleting = true;
          typeSpeed = 2000; // Pause at end
        } else if (isDeleting && charIndex === 0) {
          isDeleting = false;
          phraseIndex = (phraseIndex + 1) % phrases.length;
          typeSpeed = 300; // Pause before new word
        }

        setTimeout(type, typeSpeed);
      }

      // Start typing if phrases exist
      if (phrases.length > 0) {
        type();
      }
    }
  </script>
</section>
